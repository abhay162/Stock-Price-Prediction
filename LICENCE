
### 2. `data_preprocessing.py`
```python
import pandas as pd
from sklearn.preprocessing import MinMaxScaler

def preprocess_data(df):
    """
    Preprocesses the stock data for analysis and model training.

    Parameters:
    df (DataFrame): Raw stock data containing columns such as 'Open', 'High', 'Low', 'Close', and 'Volume'.

    Returns:
    DataFrame: Cleaned and preprocessed stock data with additional features like moving averages.
    """
    # Remove rows with missing values
    df = df.dropna()

    # Create moving averages
    df['MA50'] = df['Close'].rolling(window=50).mean()
    df['MA200'] = df['Close'].rolling(window=200).mean()

    # Normalize the 'Close', 'MA50', and 'MA200' columns using MinMaxScaler
    scaler = MinMaxScaler(feature_range=(0, 1))
    df[['Close', 'MA50', 'MA200']] = scaler.fit_transform(df[['Close', 'MA50', 'MA200']])

    return df
